---
title:  "샤딩, 파티셔닝, 레플리카 차이"
excerpt: ""

categories:
  - 스터디
last_modified_at: 2020-05-27T08:06:00-05:00
---


# 샤딩

- `샤딩` 은 단일 논리적 데이터 셋을 다수의 DB 에 쪼개어 나누는 방법이다.

- 분산된 데이터는 다수의 DB 에 저장되어 있으며 논리적으로 스키마가 같다.

- 예를 들어 id 라는 유니크하며 null 을 허용하지 않는 컬럼의 1 ~ 100_000_000 까지의 데이터는 1 번 DB 에 저장하고, 100_000_001 이후의 데이터를 2 번 DB 에 저장하는 형태가 있다.

# 샤딩을 왜 하지? 샤딩의 장점

- 하나의 DB 에 수많은 데이터가 적재되어 있고, 앞으로도 더 많은 데이터가 적재 될 예정이라면 데이터를 다수의 DB 에 쪼개어 나눔으로써 트래픽 분산의 효과를 볼 수 있다.

# 샤딩의 단점

- 아직까지 느껴보지는 못했지만 각각 다른 샤드에 있는 데이터를 가져와서 처리를 해야 할 때 코스트가 크다고 한다.

- 또 이 과정에서 다시 분산 처리를 통해 각각의 DB 에 처리할 때 동기화 이슈 등으로 무결성을 유지하는 것도 어려운 문제라고 한다.


# 파티셔닝

- `파티셔닝` 은 샤딩과 비슷하게 데이터를 분산 저장하는 것이다.

- 다만 파티셔닝에는 `수직 파티셔닝`, `수평 파티셔닝`, `범위 기반 파티셔닝`등이 있다.

# 수직 파티셔닝

- 특정 컬럼을 기준으로 나누어 파티셔닝 한다.

- 특정 컬럼의 유연성이나 정보 보안 등의 이유로 분리해야 할 때 사용한다.

- 파티셔닝 된 컬럼들은 pk 등을 참조하여 분산 된 원본 데이터와 결합 할 수 있어야 한다.

# 수평 파티셔닝

- 값을 기준으로 나누어 파티셔닝 한다.

- 샤딩과 동의어로 사용하기도 한다.

# 범위 기반 파티셔닝

- 기능 별로 파티셔닝 한다.


# 레플리카

- 한 테이블의 모든 내용을 똑같이 다른 테이블에 복제하는 기법이다.

- 이중화, 백업 디비, 미러링 등의 용어로도 통용된다.

# 레플리카를 왜 하지? 레플리카의 장점

- 마스터DB 에서 장애가 난다면 슬레이브DB 를 통해 `fail-over` 를 하기 위함이 가장 큰 목적이다.

- 또한 마스터DB 는 read/write 를 모두 가능하게 하고, 슬레이브DB 에는 read 만 가능하게 함으로서 경합을 제거하고 read 코스트를 분산을 할 수 있게 한다.

- 예를 들어 마스터DB 에 너무 많은 write 명령어가 밀려있어 원하는 read 결과를 있지 못할 때 장애로 이어질 수 있다. 이 때 레플리카를 구축해 슬레이브DB 가 있다면 장애 상황 없이 `fail-over` 할 수 있다.