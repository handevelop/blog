---
title:  "CORS"
excerpt: "cross-origin resource sharing"

categories:
  - Web
tags:
  - Web
last_modified_at: 2021-04-13T08:06:00-05:00
---

# 동일 출처 정책 (SOP:Same-Origin Policy)

- 어떤 출처에서 불러온 문서나 스크립트가 다른 출처에서 가져온 리소스와 상호작용 하는 것을 제한하는 보안 방식

- 출처가 같다는 것은 두 URL 의 프로토콜, 호스트, 포트 세 개가 모두 같음.


# 크로스 오리진 (Cross-Origin)

- 출처가 같지 않은 경우 크로스 오리진이라고 한다.


# 크로스 도메인 (Cross Domain)

- 출처 중 도메인이 다른 경우가 크로스 도메인. 보통 A 웹페이지 -> B 웹페이지로 호출 할 때 크로스 도메인 이슈가 발생한다.

- SOP 때문에 다른 페이지에 접근할 때 접근이 불가능함.

- SOP 를 우회해서 서로 다른 도메인 간에 통신을 할 수 있게 해줄 무언가 필요했다.


# CORS 의 등장

- 크로스 도메인 이슈를 해결하기 위해 표준이 등장.

- W3C 에서 발표한 권장사항.


# CORS 란

- Cross-Origin Resource Sharing 의 약자.

- 웹 브라우저에서 외부 도메인 서버와 통신하기 위한 방식을 표준화한 스팩이 CORS.

- 서버 <-> 클라이언트가 정해진 헤더를 통해 서로 요청이나 응답에 반응할지 결정하는 방식.


# CORS 동작 방식

- 서로 다른 도메인의 리소스 요청을 주고받기 위해서는 프론트와 서버에서 특정한 작업을 해주어야 한다.

- 프론트 : 리퀘스트 헤더에 CORS 관련 옵션을 넣어줘야 한다.

- 서버 : 리스폰스 헤더에 해당하는 프론트의 요청을 허용한다는 옵션을 넣어줘야 한다.

- 헤더에 뭘 넣을지는 정확하게 정해진 내용이 있고 그 것을 따르기만 하면 된다.


# 2번 호출 ??

- CORS 요청을 주고 받는 것은 프론트에서 서버로 요청을 한번만 주고받는게 아니다.

- 예를들어 겉으로는 API 요청 한번만 보내는거 같지만 실제로는 프론트에서 2번 요청을 한다.

- 첫번째 요청으로 OPTION 메소드를 보내 이 요청을 허용할 것인지 보내고 서버에서 Allowed 응답이 오면

- 두번째 요청으로 GET, POST 등의 Http 요청을 보낸 후 서버에서 그 응답을 받는다. 
